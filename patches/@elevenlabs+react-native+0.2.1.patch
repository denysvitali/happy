diff --git a/node_modules/@elevenlabs/react-native/dist/lib.js b/node_modules/@elevenlabs/react-native/dist/lib.js
index f27c2ad..cba0d6c 100644
--- a/node_modules/@elevenlabs/react-native/dist/lib.js
+++ b/node_modules/@elevenlabs/react-native/dist/lib.js
@@ -1,2 +1,2 @@
-var e=require("react"),n=require("@livekit/react-native");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=/*#__PURE__*/t(e);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o.apply(null,arguments)}var a="0.2.1",l=function(t){var o=t.onReady,a=t.isConnected,l=t.callbacks,c=t.sendMessage,i=t.clientTools,s=void 0===i?{}:i,u=t.updateCurrentEventId,d=n.useLocalParticipant().localParticipant,v=r.default.useRef(1);return e.useEffect(function(){a&&d&&o(d)},[a,d,o]),n.useDataChannel(function(e){var n,t,r=new TextDecoder,o=JSON.parse(r.decode(e.payload));if(o.type){var a;if(null==l.onMessage||l.onMessage({message:o,source:null!=(n=e.from)&&n.isAgent?"ai":"user"}),null!=(t=e.from)&&t.isAgent&&(null==l.onModeChange||l.onModeChange({mode:null!=(a=e.from)&&a.isSpeaking?"speaking":"listening"}),"agent_response"===o.type&&u)){var i=v.current++;u(i)}switch(o.type){case"ping":c({type:"pong",event_id:o.ping_event.event_id});break;case"client_tool_call":!function(e){try{return Promise.resolve(function(){if(Object.prototype.hasOwnProperty.call(s,e.client_tool_call.tool_name)){var n=function(n,t){try{var r=Promise.resolve(s[e.client_tool_call.tool_name](e.client_tool_call.parameters)).then(function(n){var t="object"==typeof n?JSON.stringify(n):String(n);c({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!1})})}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(0,function(n){null==l.onError||l.onError("Client tool execution failed with following error: "+(null==n?void 0:n.message),{clientToolName:e.client_tool_call.tool_name}),c({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:"Client tool execution failed: "+(null==n?void 0:n.message),is_error:!0})});if(n&&n.then)return n.then(function(){})}else{if(l.onUnhandledClientToolCall)return void l.onUnhandledClientToolCall(e);var t="Client tool with name "+e.client_tool_call.tool_name+" is not defined on client";null==l.onError||l.onError(t,{clientToolName:e.client_tool_call.tool_name}),c({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!0})}}())}catch(e){return Promise.reject(e)}}(o);break;default:null==l.onDebug||l.onDebug(o)}}else null==l.onDebug||l.onDebug({type:"invalid_event",message:o})}),null},c=function(e){var t=e.children;/*#__PURE__*/return r.default.createElement(n.LiveKitRoom,{serverUrl:e.serverUrl,token:e.token,connect:e.connect,audio:!0,video:!1,options:{adaptiveStream:{pixelDensity:"screen"}},onConnected:e.onConnected,onDisconnected:e.onDisconnected,onError:e.onError},/*#__PURE__*/r.default.createElement(l,{onReady:e.onParticipantReady,isConnected:e.roomConnected,callbacks:e.callbacks,sendMessage:e.sendMessage,clientTools:e.clientTools,updateCurrentEventId:e.updateCurrentEventId}),t)},i=["serverUrl","tokenFetchUrl","clientTools"],s=/*#__PURE__*/e.createContext(null);exports.ElevenLabsProvider=function(t){var l=t.children;n.registerGlobals();var i=e.useState(""),u=i[0],d=i[1],v=e.useState(!1),f=v[0],h=v[1],m=e.useState("disconnected"),g=m[0],C=m[1],_=e.useState("wss://livekit.rtc.elevenlabs.io"),k=_[0],b=_[1],p=e.useState(void 0),y=p[0],S=p[1],E=e.useState(""),P=E[0],w=E[1],x=e.useState(!1),T=x[0],U=x[1],D=e.useState(!1),R=D[0],F=D[1],I=r.default.useRef(1),M=r.default.useRef(1),j=r.default.useRef({}),O=function(){var n=e.useRef({}),t=e.useCallback(function(e){n.current=e},[]);return{callbacksRef:n,setCallbacks:t}}(),L=O.callbacksRef,A=O.setCallbacks,N=r.default.useCallback(function(e){var n=o({},e,{onModeChange:function(n){U("speaking"===n.mode),null==e.onModeChange||e.onModeChange(n)}});A(n)},[A]),V=function(n,t,r,o,l,c){var i=e.useState({}),s=i[0],u=i[1],d=e.useState(null),v=d[0],f=d[1],h=e.useState({}),m=h[0],g=h[1];return{startSession:e.useCallback(function(e){try{return Promise.resolve(function(i,s){try{var d=function(){function i(e){var n=function(e){try{var n,t;return(null==(t=((null==(n=JSON.parse(atob(e.split(".")[1])).video)?void 0:n.room)||"").match(/(conv_[a-zA-Z0-9]+)/))?void 0:t[0])||""}catch(e){return console.warn("Could not extract conversation ID from token"),""}}(s);l(n),o(s),r(!0)}var s;t("connecting"),null==n.current.onStatusChange||n.current.onStatusChange({status:"connecting"}),u(e.overrides||{}),f(e.customLlmExtraBody||null),g(e.dynamicVariables||{});var d=function(){if(!e.conversationToken)return function(){if(e.agentId)return console.info("Getting conversation token for agentId:",e.agentId),Promise.resolve(function(e,n){try{return Promise.resolve(fetch((n||"https://api.elevenlabs.io/v1/convai/conversation/token")+"?agent_id="+e+"&source=react_native_sdk&version="+a)).then(function(e){return Promise.resolve(e.json()).then(function(n){if(!e.ok)throw new Error("Failed to get conversation token: "+n.detail.message);if(!n.token)throw new Error("No conversation token received from API");return n.token})})}catch(e){return Promise.reject(e)}}(e.agentId,e.tokenFetchUrl||c)).then(function(e){s=e});throw new Error("Either conversationToken or agentId is required")}();s=e.conversationToken}();return d&&d.then?d.then(i):i()}()}catch(e){return s(e)}return d&&d.then?d.then(void 0,s):d}(0,function(e){throw t("disconnected"),null==n.current.onStatusChange||n.current.onStatusChange({status:"disconnected"}),null==n.current.onError||n.current.onError(e),e}))}catch(e){return Promise.reject(e)}},[n,t,r,o,l,c]),endSession:e.useCallback(function(){try{try{r(!1),o(""),t("disconnected"),null==n.current.onStatusChange||n.current.onStatusChange({status:"disconnected"}),null==n.current.onDisconnect||n.current.onDisconnect("User ended conversation")}catch(e){throw null==n.current.onError||n.current.onError(e),e}return Promise.resolve()}catch(e){return Promise.reject(e)}},[n,r,o,t]),overrides:s,customLlmExtraBody:v,dynamicVariables:m}}(L,C,h,d,w,y),B=V.startSession,J=V.endSession,q=V.overrides,K=V.customLlmExtraBody,G=V.dynamicVariables,z=function(t,r,o){var a=e.useState(!1),l=a[0],c=a[1],i=e.useState(null),s=i[0],u=i[1];return e.useEffect(function(){return function(){try{return Promise.resolve(n.AudioSession.startAudioSession()).then(function(){})}catch(e){return Promise.reject(e)}}(),function(){n.AudioSession.stopAudioSession()}},[]),{roomConnected:l,localParticipant:s,handleParticipantReady:e.useCallback(function(e){u(e)},[]),handleConnected:e.useCallback(function(){c(!0),r("connected"),null==t.current.onConnect||t.current.onConnect({conversationId:o})},[o,t,r]),handleDisconnected:e.useCallback(function(){c(!1),r("disconnected"),u(null),null==t.current.onDisconnect||t.current.onDisconnect("disconnected")},[t,r]),handleError:e.useCallback(function(e){console.error("LiveKit error:",e),null==t.current.onError||t.current.onError(e.message,void 0)},[t])}}(L,C,P),W=z.roomConnected,Z=z.localParticipant,H=z.handleParticipantReady,Q=z.handleConnected,X=z.handleDisconnected,Y=z.handleError,$=r.default.useCallback(function(){I.current=1,M.current=1,F(!1),null==L.current.onCanSendFeedbackChange||L.current.onCanSendFeedbackChange({canSendFeedback:!1}),Q()},[Q,L]),ee=r.default.useCallback(function(){F(!1),X()},[X]),ne=function(n,t,r){return{sendMessage:e.useCallback(function(e){try{if("connected"!==n||!t)return console.warn("Cannot send message: room not connected or no local participant"),Promise.resolve();var o=function(n,r){try{var o=(a=(new TextEncoder).encode(JSON.stringify(e)),Promise.resolve(t.publishData(a,{reliable:!0})).then(function(){}))}catch(e){return r(e)}var a;return o&&o.then?o.then(void 0,r):o}(0,function(e){console.error("Failed to send message via WebRTC:",e),console.error("Error details:",e),null==r.current.onError||r.current.onError(e)});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},[n,t,r])}}(g,Z,L),te=ne.sendMessage,re=r.default.useCallback(function(){var e=I.current!==M.current;R!==e&&(F(e),null==L.current.onCanSendFeedbackChange||L.current.onCanSendFeedbackChange({canSendFeedback:e}))},[R,L]),oe=r.default.useCallback(function(e){R?(te({type:"feedback",score:e?"like":"dislike",event_id:I.current}),M.current=I.current,re()):console.warn(0===M.current?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},[R,te,re]);r.default.useCallback(function(e){console.warn("setVolume is not yet implemented in React Native SDK")},[]);var ae=r.default.useCallback(function(e){I.current=e,re()},[re]),le=r.default.useCallback(function(e){if(H(e),Z){var n=function(e){var n,t,r,o,l,c,i={type:"conversation_initiation_client_data"};return e.overrides&&(i.conversation_config_override={agent:{prompt:null==(n=e.overrides.agent)?void 0:n.prompt,first_message:null==(t=e.overrides.agent)?void 0:t.firstMessage,language:null==(r=e.overrides.agent)?void 0:r.language},tts:{voice_id:null==(o=e.overrides.tts)?void 0:o.voiceId},conversation:{text_only:null==(l=e.overrides.conversation)?void 0:l.textOnly},source_info:{source:"react_native_sdk",version:(null==(c=e.overrides)||null==(c=c.client)?void 0:c.version)||a}}),e.customLlmExtraBody&&(i.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(i.dynamic_variables=e.dynamicVariables),e.userId&&(i.user_id=e.userId),i}({overrides:q,customLlmExtraBody:K,dynamicVariables:G});te(n)}},[H,Z,q,K,G,te]),ce={startSession:B,endSession:J,status:g,isSpeaking:T,canSendFeedback:R,getId:function(){return P},sendFeedback:oe,sendContextualUpdate:function(e){te({type:"contextual_update",text:e})},sendUserMessage:function(e){te({type:"user_message",text:e})},sendUserActivity:function(){te({type:"user_activity"})}},ie=r.default.useCallback(function(e){j.current=e},[]);/*#__PURE__*/return r.default.createElement(s.Provider,{value:{conversation:ce,callbacksRef:L,serverUrl:k,tokenFetchUrl:y,clientTools:j.current,setCallbacks:N,setServerUrl:b,setTokenFetchUrl:S,setClientTools:ie}},/*#__PURE__*/r.default.createElement(c,{serverUrl:k,token:u,connect:f,onConnected:$,onDisconnected:ee,onError:Y,roomConnected:W,callbacks:L.current,onParticipantReady:le,sendMessage:te,clientTools:j.current,updateCurrentEventId:ae},l))},exports.useConversation=function(n){void 0===n&&(n={});var t=e.useContext(s);if(!t)throw new Error("useConversation must be used within ElevenLabsProvider");var o=n.serverUrl,a=n.tokenFetchUrl,l=n.clientTools,c=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(n,i);return r.default.useEffect(function(){o&&t.setServerUrl(o)},[t,o]),r.default.useEffect(function(){a&&t.setTokenFetchUrl(a)},[t,a]),l&&t.setClientTools(l),t.setCallbacks(c),t.conversation};
+var e=require("react"),n=require("@livekit/react-native");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=/*#__PURE__*/t(e);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o.apply(null,arguments)}var a="0.2.1",l=function(t){var o=t.onReady,a=t.isConnected,l=t.callbacks,c=t.sendMessage,i=t.clientTools,s=void 0===i?{}:i,u=t.updateCurrentEventId,d=n.useLocalParticipant().localParticipant,v=r.default.useRef(1);return e.useEffect(function(){a&&d&&o(d)},[a,d,o]),n.useDataChannel(function(e){var n,t,r=new TextDecoder,o=JSON.parse(r.decode(e.payload));if(o.type){var a;if(null==l.onMessage||l.onMessage({message:o,source:null!=(n=e.from)&&n.isAgent?"ai":"user"}),null!=(t=e.from)&&t.isAgent&&(null==l.onModeChange||l.onModeChange({mode:null!=(a=e.from)&&a.isSpeaking?"speaking":"listening"}),"agent_response"===o.type&&u)){var i=v.current++;u(i)}switch(o.type){case"ping":c({type:"pong",event_id:o.ping_event.event_id});break;case"client_tool_call":!function(e){try{return Promise.resolve(function(){if(Object.prototype.hasOwnProperty.call(s,e.client_tool_call.tool_name)){var n=function(n,t){try{var r=Promise.resolve(s[e.client_tool_call.tool_name](e.client_tool_call.parameters)).then(function(n){var t="object"==typeof n?JSON.stringify(n):String(n);c({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!1})})}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(0,function(n){null==l.onError||l.onError("Client tool execution failed with following error: "+(null==n?void 0:n.message),{clientToolName:e.client_tool_call.tool_name}),c({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:"Client tool execution failed: "+(null==n?void 0:n.message),is_error:!0})});if(n&&n.then)return n.then(function(){})}else{if(l.onUnhandledClientToolCall)return void l.onUnhandledClientToolCall(e);var t="Client tool with name "+e.client_tool_call.tool_name+" is not defined on client";null==l.onError||l.onError(t,{clientToolName:e.client_tool_call.tool_name}),c({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!0})}}())}catch(e){return Promise.reject(e)}}(o);break;default:null==l.onDebug||l.onDebug(o)}}else null==l.onDebug||l.onDebug({type:"invalid_event",message:o})}),null},c=function(e){var t=e.children;/*#__PURE__*/return r.default.createElement(n.LiveKitRoom,{serverUrl:e.serverUrl,token:e.token,connect:e.connect,audio:!0,video:!1,options:{adaptiveStream:{pixelDensity:"screen"}},onConnected:e.onConnected,onDisconnected:e.onDisconnected,onError:e.onError},/*#__PURE__*/r.default.createElement(l,{onReady:e.onParticipantReady,isConnected:e.roomConnected,callbacks:e.callbacks,sendMessage:e.sendMessage,clientTools:e.clientTools,updateCurrentEventId:e.updateCurrentEventId}),t)},i=["serverUrl","tokenFetchUrl","clientTools"],s=/*#__PURE__*/e.createContext(null);exports.ElevenLabsProvider=function(t){var l=t.children;n.registerGlobals();var i=e.useState(""),u=i[0],d=i[1],v=e.useState(!1),f=v[0],h=v[1],m=e.useState("disconnected"),g=m[0],C=m[1],_=e.useState("wss://livekit.rtc.elevenlabs.io"),k=_[0],b=_[1],p=e.useState(void 0),y=p[0],S=p[1],E=e.useState(""),P=E[0],w=E[1],x=e.useState(!1),T=x[0],U=x[1],D=e.useState(!1),R=D[0],F=D[1],I=r.default.useRef(1),M=r.default.useRef(1),j=r.default.useRef({}),O=function(){var n=e.useRef({}),t=e.useCallback(function(e){n.current=e},[]);return{callbacksRef:n,setCallbacks:t}}(),L=O.callbacksRef,A=O.setCallbacks,N=r.default.useCallback(function(e){var n=o({},e,{onModeChange:function(n){U("speaking"===n.mode),null==e.onModeChange||e.onModeChange(n)}});A(n)},[A]),V=function(n,t,r,o,l,c){var i=e.useState({}),s=i[0],u=i[1],d=e.useState(null),v=d[0],f=d[1],h=e.useState({}),m=h[0],g=h[1];return{startSession:e.useCallback(function(e){try{return Promise.resolve(function(i,s){try{var d=function(){function i(e){var n=function(e){try{var n,t;return(null==(t=((null==(n=JSON.parse(atob(e.split(".")[1])).video)?void 0:n.room)||"").match(/(conv_[a-zA-Z0-9]+)/))?void 0:t[0])||""}catch(e){return console.warn("Could not extract conversation ID from token"),""}}(s);l(n),o(s),r(!0)}var s;t("connecting"),null==n.current.onStatusChange||n.current.onStatusChange({status:"connecting"}),u(e.overrides||{}),f(e.customLlmExtraBody||null),g(e.dynamicVariables||{});var d=function(){if(!e.conversationToken)return function(){if(e.agentId)return console.info("Getting conversation token for agentId:",e.agentId),Promise.resolve(function(e,n){try{return Promise.resolve(fetch((n||"https://api.elevenlabs.io/v1/convai/conversation/token")+"?agent_id="+e+"&source=react_native_sdk&version="+a)).then(function(e){return Promise.resolve(e.json()).then(function(n){if(!e.ok)throw new Error("Failed to get conversation token: "+n.detail.message);if(!n.token)throw new Error("No conversation token received from API");return n.token})})}catch(e){return Promise.reject(e)}}(e.agentId,e.tokenFetchUrl||c)).then(function(e){s=e});throw new Error("Either conversationToken or agentId is required")}();s=e.conversationToken}();return d&&d.then?d.then(i):i()}()}catch(e){return s(e)}return d&&d.then?d.then(void 0,s):d}(0,function(e){throw t("disconnected"),null==n.current.onStatusChange||n.current.onStatusChange({status:"disconnected"}),null==n.current.onError||n.current.onError(e),e}))}catch(e){return Promise.reject(e)}},[n,t,r,o,l,c]),endSession:e.useCallback(function(){try{try{r(!1),o(""),t("disconnected"),null==n.current.onStatusChange||n.current.onStatusChange({status:"disconnected"}),null==n.current.onDisconnect||n.current.onDisconnect("User ended conversation")}catch(e){throw null==n.current.onError||n.current.onError(e),e}return Promise.resolve()}catch(e){return Promise.reject(e)}},[n,r,o,t]),overrides:s,customLlmExtraBody:v,dynamicVariables:m}}(L,C,h,d,w,y),B=V.startSession,J=V.endSession,q=V.overrides,K=V.customLlmExtraBody,G=V.dynamicVariables,z=function(t,r,o,_connect){var a=e.useState(!1),l=a[0],c=a[1],i=e.useState(null),s=i[0],u=i[1];return e.useEffect(function(){if(_connect){return function(){try{return Promise.resolve(n.AudioSession.startAudioSession()).then(function(){})}catch(e){return Promise.reject(e)}}(),function(){n.AudioSession.stopAudioSession()}}},[_connect]),{roomConnected:l,localParticipant:s,handleParticipantReady:e.useCallback(function(e){u(e)},[]),handleConnected:e.useCallback(function(){c(!0),r("connected"),null==t.current.onConnect||t.current.onConnect({conversationId:o})},[o,t,r]),handleDisconnected:e.useCallback(function(){c(!1),r("disconnected"),u(null),null==t.current.onDisconnect||t.current.onDisconnect("disconnected")},[t,r]),handleError:e.useCallback(function(e){console.error("LiveKit error:",e),null==t.current.onError||t.current.onError(e.message,void 0)},[t])}}(L,C,P,f),W=z.roomConnected,Z=z.localParticipant,H=z.handleParticipantReady,Q=z.handleConnected,X=z.handleDisconnected,Y=z.handleError,$=r.default.useCallback(function(){I.current=1,M.current=1,F(!1),null==L.current.onCanSendFeedbackChange||L.current.onCanSendFeedbackChange({canSendFeedback:!1}),Q()},[Q,L]),ee=r.default.useCallback(function(){F(!1),X()},[X]),ne=function(n,t,r){return{sendMessage:e.useCallback(function(e){try{if("connected"!==n||!t)return console.warn("Cannot send message: room not connected or no local participant"),Promise.resolve();var o=function(n,r){try{var o=(a=(new TextEncoder).encode(JSON.stringify(e)),Promise.resolve(t.publishData(a,{reliable:!0})).then(function(){}))}catch(e){return r(e)}var a;return o&&o.then?o.then(void 0,r):o}(0,function(e){console.error("Failed to send message via WebRTC:",e),console.error("Error details:",e),null==r.current.onError||r.current.onError(e)});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},[n,t,r])}}(g,Z,L),te=ne.sendMessage,re=r.default.useCallback(function(){var e=I.current!==M.current;R!==e&&(F(e),null==L.current.onCanSendFeedbackChange||L.current.onCanSendFeedbackChange({canSendFeedback:e}))},[R,L]),oe=r.default.useCallback(function(e){R?(te({type:"feedback",score:e?"like":"dislike",event_id:I.current}),M.current=I.current,re()):console.warn(0===M.current?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},[R,te,re]);r.default.useCallback(function(e){console.warn("setVolume is not yet implemented in React Native SDK")},[]);var ae=r.default.useCallback(function(e){I.current=e,re()},[re]),le=r.default.useCallback(function(e){if(H(e),Z){var n=function(e){var n,t,r,o,l,c,i={type:"conversation_initiation_client_data"};return e.overrides&&(i.conversation_config_override={agent:{prompt:null==(n=e.overrides.agent)?void 0:n.prompt,first_message:null==(t=e.overrides.agent)?void 0:t.firstMessage,language:null==(r=e.overrides.agent)?void 0:r.language},tts:{voice_id:null==(o=e.overrides.tts)?void 0:o.voiceId},conversation:{text_only:null==(l=e.overrides.conversation)?void 0:l.textOnly},source_info:{source:"react_native_sdk",version:(null==(c=e.overrides)||null==(c=c.client)?void 0:c.version)||a}}),e.customLlmExtraBody&&(i.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(i.dynamic_variables=e.dynamicVariables),e.userId&&(i.user_id=e.userId),i}({overrides:q,customLlmExtraBody:K,dynamicVariables:G});te(n)}},[H,Z,q,K,G,te]),ce={startSession:B,endSession:J,status:g,isSpeaking:T,canSendFeedback:R,getId:function(){return P},sendFeedback:oe,sendContextualUpdate:function(e){te({type:"contextual_update",text:e})},sendUserMessage:function(e){te({type:"user_message",text:e})},sendUserActivity:function(){te({type:"user_activity"})}},ie=r.default.useCallback(function(e){j.current=e},[]);/*#__PURE__*/return r.default.createElement(s.Provider,{value:{conversation:ce,callbacksRef:L,serverUrl:k,tokenFetchUrl:y,clientTools:j.current,setCallbacks:N,setServerUrl:b,setTokenFetchUrl:S,setClientTools:ie}},/*#__PURE__*/r.default.createElement(c,{serverUrl:k,token:u,connect:f,onConnected:$,onDisconnected:ee,onError:Y,roomConnected:W,callbacks:L.current,onParticipantReady:le,sendMessage:te,clientTools:j.current,updateCurrentEventId:ae},l))},exports.useConversation=function(n){void 0===n&&(n={});var t=e.useContext(s);if(!t)throw new Error("useConversation must be used within ElevenLabsProvider");var o=n.serverUrl,a=n.tokenFetchUrl,l=n.clientTools,c=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(n,i);return r.default.useEffect(function(){o&&t.setServerUrl(o)},[t,o]),r.default.useEffect(function(){a&&t.setTokenFetchUrl(a)},[t,a]),l&&t.setClientTools(l),t.setCallbacks(c),t.conversation};
 //# sourceMappingURL=lib.js.map
diff --git a/node_modules/@elevenlabs/react-native/dist/lib.modern.js b/node_modules/@elevenlabs/react-native/dist/lib.modern.js
index e43c61c..3bffdab 100644
--- a/node_modules/@elevenlabs/react-native/dist/lib.modern.js
+++ b/node_modules/@elevenlabs/react-native/dist/lib.modern.js
@@ -1,2 +1,2 @@
-import e,{useRef as n,useCallback as t,useState as o,useEffect as r,useContext as l,createContext as a}from"react";import{AudioSession as c,useLocalParticipant as s,useDataChannel as i,LiveKitRoom as d,registerGlobals as u}from"@livekit/react-native";function v(){return v=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)({}).hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},v.apply(null,arguments)}const g="0.2.1",_=({onReady:n,isConnected:t,callbacks:o,sendMessage:l,clientTools:a={},updateCurrentEventId:c})=>{const{localParticipant:d}=s(),u=e.useRef(1);return r(()=>{t&&d&&n(d)},[t,d,n]),i(e=>{var n,t;const r=new TextDecoder,s=JSON.parse(r.decode(e.payload));if(s.type){var i;if(null==o.onMessage||o.onMessage({message:s,source:null!=(n=e.from)&&n.isAgent?"ai":"user"}),null!=(t=e.from)&&t.isAgent&&(null==o.onModeChange||o.onModeChange({mode:null!=(i=e.from)&&i.isSpeaking?"speaking":"listening"}),"agent_response"===s.type&&c)){const e=u.current++;c(e)}switch(s.type){case"ping":l({type:"pong",event_id:s.ping_event.event_id});break;case"client_tool_call":(async e=>{if(Object.prototype.hasOwnProperty.call(a,e.client_tool_call.tool_name))try{var n;const t=null!=(n=await a[e.client_tool_call.tool_name](e.client_tool_call.parameters))?n:"Client tool execution successful.",o="object"==typeof t?JSON.stringify(t):String(t);l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:o,is_error:!1})}catch(n){null==o.onError||o.onError(`Client tool execution failed with following error: ${null==n?void 0:n.message}`,{clientToolName:e.client_tool_call.tool_name}),l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool execution failed: ${null==n?void 0:n.message}`,is_error:!0})}else{if(o.onUnhandledClientToolCall)return void o.onUnhandledClientToolCall(e);const n=`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`;null==o.onError||o.onError(n,{clientToolName:e.client_tool_call.tool_name}),l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:n,is_error:!0})}})(s);break;default:null==o.onDebug||o.onDebug(s)}}else null==o.onDebug||o.onDebug({type:"invalid_event",message:s})}),null},m=({children:n,serverUrl:t,token:o,connect:r,onConnected:l,onDisconnected:a,onError:c,roomConnected:s,callbacks:i,onParticipantReady:u,sendMessage:v,clientTools:g,updateCurrentEventId:m})=>/*#__PURE__*/e.createElement(d,{serverUrl:t,token:o,connect:r,audio:!0,video:!1,options:{adaptiveStream:{pixelDensity:"screen"}},onConnected:l,onDisconnected:a,onError:c},/*#__PURE__*/e.createElement(_,{onReady:u,isConnected:s,callbacks:i,sendMessage:v,clientTools:g,updateCurrentEventId:m}),n),C=["serverUrl","tokenFetchUrl","clientTools"],p=/*#__PURE__*/a(null),k=(n={})=>{const t=l(p);if(!t)throw new Error("useConversation must be used within ElevenLabsProvider");const{serverUrl:o,tokenFetchUrl:r,clientTools:a}=n,c=function(e,n){if(null==e)return{};var t={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==n.indexOf(o))continue;t[o]=e[o]}return t}(n,C);return e.useEffect(()=>{o&&t.setServerUrl(o)},[t,o]),e.useEffect(()=>{r&&t.setTokenFetchUrl(r)},[t,r]),a&&t.setClientTools(a),t.setCallbacks(c),t.conversation},f=({children:l})=>{u();const[a,s]=o(""),[i,d]=o(!1),[_,C]=o("disconnected"),[k,f]=o("wss://livekit.rtc.elevenlabs.io"),[h,y]=o(void 0),[b,E]=o(""),[S,w]=o(!1),[x,T]=o(!1),U=e.useRef(1),D=e.useRef(1),F=e.useRef({}),{callbacksRef:I,setCallbacks:M}=(()=>{const e=n({}),o=t(n=>{e.current=n},[]);return{callbacksRef:e,setCallbacks:o}})(),R=e.useCallback(e=>{const n=v({},e,{onModeChange:n=>{w("speaking"===n.mode),null==e.onModeChange||e.onModeChange(n)}});M(n)},[M]),{startSession:P,endSession:O,overrides:L,customLlmExtraBody:N,dynamicVariables:A}=((e,n,r,l,a,c)=>{const[s,i]=o({}),[d,u]=o(null),[v,_]=o({});return{startSession:t(async t=>{try{let o;if(n("connecting"),null==e.current.onStatusChange||e.current.onStatusChange({status:"connecting"}),i(t.overrides||{}),u(t.customLlmExtraBody||null),_(t.dynamicVariables||{}),t.conversationToken)o=t.conversationToken;else{if(!t.agentId)throw new Error("Either conversationToken or agentId is required");{console.info("Getting conversation token for agentId:",t.agentId);const e=t.tokenFetchUrl||c;o=await(async(e,n)=>{const t=n||"https://api.elevenlabs.io/v1/convai/conversation/token",o=await fetch(`${t}?agent_id=${e}&source=react_native_sdk&version=${g}`),r=await o.json();if(!o.ok)throw new Error(`Failed to get conversation token: ${r.detail.message}`);if(!r.token)throw new Error("No conversation token received from API");return r.token})(t.agentId,e)}}const s=(e=>{try{var n,t;return(null==(t=((null==(n=JSON.parse(atob(e.split(".")[1])).video)?void 0:n.room)||"").match(/(conv_[a-zA-Z0-9]+)/))?void 0:t[0])||""}catch(e){return console.warn("Could not extract conversation ID from token"),""}})(o);a(s),l(o),r(!0)}catch(t){throw n("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onError||e.current.onError(t),t}},[e,n,r,l,a,c]),endSession:t(async()=>{try{r(!1),l(""),n("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onDisconnect||e.current.onDisconnect("User ended conversation")}catch(n){throw null==e.current.onError||e.current.onError(n),n}},[e,r,l,n]),overrides:s,customLlmExtraBody:d,dynamicVariables:v}})(I,C,d,s,E,h),{roomConnected:V,localParticipant:$,handleParticipantReady:B,handleConnected:j,handleDisconnected:J,handleError:K}=((e,n,l)=>{const[a,s]=o(!1),[i,d]=o(null);return r(()=>((async()=>{await c.startAudioSession()})(),()=>{c.stopAudioSession()}),[]),{roomConnected:a,localParticipant:i,handleParticipantReady:t(e=>{d(e)},[]),handleConnected:t(()=>{s(!0),n("connected"),null==e.current.onConnect||e.current.onConnect({conversationId:l})},[l,e,n]),handleDisconnected:t(()=>{s(!1),n("disconnected"),d(null),null==e.current.onDisconnect||e.current.onDisconnect("disconnected")},[e,n]),handleError:t(n=>{console.error("LiveKit error:",n),null==e.current.onError||e.current.onError(n.message,void 0)},[e])}})(I,C,b),q=e.useCallback(()=>{U.current=1,D.current=1,T(!1),null==I.current.onCanSendFeedbackChange||I.current.onCanSendFeedbackChange({canSendFeedback:!1}),j()},[j,I]),z=e.useCallback(()=>{T(!1),J()},[J]),{sendMessage:G}=((e,n,o)=>({sendMessage:t(async t=>{if("connected"===e&&n)try{const e=(new TextEncoder).encode(JSON.stringify(t));await n.publishData(e,{reliable:!0})}catch(e){console.error("Failed to send message via WebRTC:",e),console.error("Error details:",e),null==o.current.onError||o.current.onError(e)}else console.warn("Cannot send message: room not connected or no local participant")},[e,n,o])}))(_,$,I),W=e.useCallback(()=>{const e=U.current!==D.current;x!==e&&(T(e),null==I.current.onCanSendFeedbackChange||I.current.onCanSendFeedbackChange({canSendFeedback:e}))},[x,I]),Z=e.useCallback(e=>{x?(G({type:"feedback",score:e?"like":"dislike",event_id:U.current}),D.current=U.current,W()):console.warn(0===D.current?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},[x,G,W]);e.useCallback(e=>{console.warn("setVolume is not yet implemented in React Native SDK")},[]);const H=e.useCallback(e=>{U.current=e,W()},[W]),Q=e.useCallback(e=>{if(B(e),$){const e=function(e){const n={type:"conversation_initiation_client_data"};var t,o,r,l,a,c;return e.overrides&&(n.conversation_config_override={agent:{prompt:null==(t=e.overrides.agent)?void 0:t.prompt,first_message:null==(o=e.overrides.agent)?void 0:o.firstMessage,language:null==(r=e.overrides.agent)?void 0:r.language},tts:{voice_id:null==(l=e.overrides.tts)?void 0:l.voiceId},conversation:{text_only:null==(a=e.overrides.conversation)?void 0:a.textOnly},source_info:{source:"react_native_sdk",version:(null==(c=e.overrides)||null==(c=c.client)?void 0:c.version)||g}}),e.customLlmExtraBody&&(n.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(n.dynamic_variables=e.dynamicVariables),e.userId&&(n.user_id=e.userId),n}({overrides:L,customLlmExtraBody:N,dynamicVariables:A});G(e)}},[B,$,L,N,A,G]),X={startSession:P,endSession:O,status:_,isSpeaking:S,canSendFeedback:x,getId:()=>b,sendFeedback:Z,sendContextualUpdate:e=>{G({type:"contextual_update",text:e})},sendUserMessage:e=>{G({type:"user_message",text:e})},sendUserActivity:()=>{G({type:"user_activity"})}},Y=e.useCallback(e=>{F.current=e},[]);/*#__PURE__*/return e.createElement(p.Provider,{value:{conversation:X,callbacksRef:I,serverUrl:k,tokenFetchUrl:h,clientTools:F.current,setCallbacks:R,setServerUrl:f,setTokenFetchUrl:y,setClientTools:Y}},/*#__PURE__*/e.createElement(m,{serverUrl:k,token:a,connect:i,onConnected:q,onDisconnected:z,onError:K,roomConnected:V,callbacks:I.current,onParticipantReady:Q,sendMessage:G,clientTools:F.current,updateCurrentEventId:H},l))};export{f as ElevenLabsProvider,k as useConversation};
+import e,{useRef as n,useCallback as t,useState as o,useEffect as r,useContext as l,createContext as a}from"react";import{AudioSession as c,useLocalParticipant as s,useDataChannel as i,LiveKitRoom as d,registerGlobals as u}from"@livekit/react-native";function v(){return v=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)({}).hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},v.apply(null,arguments)}const g="0.2.1",_=({onReady:n,isConnected:t,callbacks:o,sendMessage:l,clientTools:a={},updateCurrentEventId:c})=>{const{localParticipant:d}=s(),u=e.useRef(1);return r(()=>{t&&d&&n(d)},[t,d,n]),i(e=>{var n,t;const r=new TextDecoder,s=JSON.parse(r.decode(e.payload));if(s.type){var i;if(null==o.onMessage||o.onMessage({message:s,source:null!=(n=e.from)&&n.isAgent?"ai":"user"}),null!=(t=e.from)&&t.isAgent&&(null==o.onModeChange||o.onModeChange({mode:null!=(i=e.from)&&i.isSpeaking?"speaking":"listening"}),"agent_response"===s.type&&c)){const e=u.current++;c(e)}switch(s.type){case"ping":l({type:"pong",event_id:s.ping_event.event_id});break;case"client_tool_call":(async e=>{if(Object.prototype.hasOwnProperty.call(a,e.client_tool_call.tool_name))try{var n;const t=null!=(n=await a[e.client_tool_call.tool_name](e.client_tool_call.parameters))?n:"Client tool execution successful.",o="object"==typeof t?JSON.stringify(t):String(t);l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:o,is_error:!1})}catch(n){null==o.onError||o.onError(`Client tool execution failed with following error: ${null==n?void 0:n.message}`,{clientToolName:e.client_tool_call.tool_name}),l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool execution failed: ${null==n?void 0:n.message}`,is_error:!0})}else{if(o.onUnhandledClientToolCall)return void o.onUnhandledClientToolCall(e);const n=`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`;null==o.onError||o.onError(n,{clientToolName:e.client_tool_call.tool_name}),l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:n,is_error:!0})}})(s);break;default:null==o.onDebug||o.onDebug(s)}}else null==o.onDebug||o.onDebug({type:"invalid_event",message:s})}),null},m=({children:n,serverUrl:t,token:o,connect:r,onConnected:l,onDisconnected:a,onError:c,roomConnected:s,callbacks:i,onParticipantReady:u,sendMessage:v,clientTools:g,updateCurrentEventId:m})=>/*#__PURE__*/e.createElement(d,{serverUrl:t,token:o,connect:r,audio:!0,video:!1,options:{adaptiveStream:{pixelDensity:"screen"}},onConnected:l,onDisconnected:a,onError:c},/*#__PURE__*/e.createElement(_,{onReady:u,isConnected:s,callbacks:i,sendMessage:v,clientTools:g,updateCurrentEventId:m}),n),C=["serverUrl","tokenFetchUrl","clientTools"],p=/*#__PURE__*/a(null),k=(n={})=>{const t=l(p);if(!t)throw new Error("useConversation must be used within ElevenLabsProvider");const{serverUrl:o,tokenFetchUrl:r,clientTools:a}=n,c=function(e,n){if(null==e)return{};var t={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==n.indexOf(o))continue;t[o]=e[o]}return t}(n,C);return e.useEffect(()=>{o&&t.setServerUrl(o)},[t,o]),e.useEffect(()=>{r&&t.setTokenFetchUrl(r)},[t,r]),a&&t.setClientTools(a),t.setCallbacks(c),t.conversation},f=({children:l})=>{u();const[a,s]=o(""),[i,d]=o(!1),[_,C]=o("disconnected"),[k,f]=o("wss://livekit.rtc.elevenlabs.io"),[h,y]=o(void 0),[b,E]=o(""),[S,w]=o(!1),[x,T]=o(!1),U=e.useRef(1),D=e.useRef(1),F=e.useRef({}),{callbacksRef:I,setCallbacks:M}=(()=>{const e=n({}),o=t(n=>{e.current=n},[]);return{callbacksRef:e,setCallbacks:o}})(),R=e.useCallback(e=>{const n=v({},e,{onModeChange:n=>{w("speaking"===n.mode),null==e.onModeChange||e.onModeChange(n)}});M(n)},[M]),{startSession:P,endSession:O,overrides:L,customLlmExtraBody:N,dynamicVariables:A}=((e,n,r,l,a,c)=>{const[s,i]=o({}),[d,u]=o(null),[v,_]=o({});return{startSession:t(async t=>{try{let o;if(n("connecting"),null==e.current.onStatusChange||e.current.onStatusChange({status:"connecting"}),i(t.overrides||{}),u(t.customLlmExtraBody||null),_(t.dynamicVariables||{}),t.conversationToken)o=t.conversationToken;else{if(!t.agentId)throw new Error("Either conversationToken or agentId is required");{console.info("Getting conversation token for agentId:",t.agentId);const e=t.tokenFetchUrl||c;o=await(async(e,n)=>{const t=n||"https://api.elevenlabs.io/v1/convai/conversation/token",o=await fetch(`${t}?agent_id=${e}&source=react_native_sdk&version=${g}`),r=await o.json();if(!o.ok)throw new Error(`Failed to get conversation token: ${r.detail.message}`);if(!r.token)throw new Error("No conversation token received from API");return r.token})(t.agentId,e)}}const s=(e=>{try{var n,t;return(null==(t=((null==(n=JSON.parse(atob(e.split(".")[1])).video)?void 0:n.room)||"").match(/(conv_[a-zA-Z0-9]+)/))?void 0:t[0])||""}catch(e){return console.warn("Could not extract conversation ID from token"),""}})(o);a(s),l(o),r(!0)}catch(t){throw n("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onError||e.current.onError(t),t}},[e,n,r,l,a,c]),endSession:t(async()=>{try{r(!1),l(""),n("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onDisconnect||e.current.onDisconnect("User ended conversation")}catch(n){throw null==e.current.onError||e.current.onError(n),n}},[e,r,l,n]),overrides:s,customLlmExtraBody:d,dynamicVariables:v}})(I,C,d,s,E,h),{roomConnected:V,localParticipant:$,handleParticipantReady:B,handleConnected:j,handleDisconnected:J,handleError:K}=((e,n,l,_connect)=>{const[a,s]=o(!1),[i,d]=o(null);return r(()=>{if(_connect){return((async()=>{await c.startAudioSession()})(),()=>{c.stopAudioSession()})}},[_connect]),{roomConnected:a,localParticipant:i,handleParticipantReady:t(e=>{d(e)},[]),handleConnected:t(()=>{s(!0),n("connected"),null==e.current.onConnect||e.current.onConnect({conversationId:l})},[l,e,n]),handleDisconnected:t(()=>{s(!1),n("disconnected"),d(null),null==e.current.onDisconnect||e.current.onDisconnect("disconnected")},[e,n]),handleError:t(n=>{console.error("LiveKit error:",n),null==e.current.onError||e.current.onError(n.message,void 0)},[e])}})(I,C,b,i),q=e.useCallback(()=>{U.current=1,D.current=1,T(!1),null==I.current.onCanSendFeedbackChange||I.current.onCanSendFeedbackChange({canSendFeedback:!1}),j()},[j,I]),z=e.useCallback(()=>{T(!1),J()},[J]),{sendMessage:G}=((e,n,o)=>({sendMessage:t(async t=>{if("connected"===e&&n)try{const e=(new TextEncoder).encode(JSON.stringify(t));await n.publishData(e,{reliable:!0})}catch(e){console.error("Failed to send message via WebRTC:",e),console.error("Error details:",e),null==o.current.onError||o.current.onError(e)}else console.warn("Cannot send message: room not connected or no local participant")},[e,n,o])}))(_,$,I),W=e.useCallback(()=>{const e=U.current!==D.current;x!==e&&(T(e),null==I.current.onCanSendFeedbackChange||I.current.onCanSendFeedbackChange({canSendFeedback:e}))},[x,I]),Z=e.useCallback(e=>{x?(G({type:"feedback",score:e?"like":"dislike",event_id:U.current}),D.current=U.current,W()):console.warn(0===D.current?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},[x,G,W]);e.useCallback(e=>{console.warn("setVolume is not yet implemented in React Native SDK")},[]);const H=e.useCallback(e=>{U.current=e,W()},[W]),Q=e.useCallback(e=>{if(B(e),$){const e=function(e){const n={type:"conversation_initiation_client_data"};var t,o,r,l,a,c;return e.overrides&&(n.conversation_config_override={agent:{prompt:null==(t=e.overrides.agent)?void 0:t.prompt,first_message:null==(o=e.overrides.agent)?void 0:o.firstMessage,language:null==(r=e.overrides.agent)?void 0:r.language},tts:{voice_id:null==(l=e.overrides.tts)?void 0:l.voiceId},conversation:{text_only:null==(a=e.overrides.conversation)?void 0:a.textOnly},source_info:{source:"react_native_sdk",version:(null==(c=e.overrides)||null==(c=c.client)?void 0:c.version)||g}}),e.customLlmExtraBody&&(n.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(n.dynamic_variables=e.dynamicVariables),e.userId&&(n.user_id=e.userId),n}({overrides:L,customLlmExtraBody:N,dynamicVariables:A});G(e)}},[B,$,L,N,A,G]),X={startSession:P,endSession:O,status:_,isSpeaking:S,canSendFeedback:x,getId:()=>b,sendFeedback:Z,sendContextualUpdate:e=>{G({type:"contextual_update",text:e})},sendUserMessage:e=>{G({type:"user_message",text:e})},sendUserActivity:()=>{G({type:"user_activity"})}},Y=e.useCallback(e=>{F.current=e},[]);/*#__PURE__*/return e.createElement(p.Provider,{value:{conversation:X,callbacksRef:I,serverUrl:k,tokenFetchUrl:h,clientTools:F.current,setCallbacks:R,setServerUrl:f,setTokenFetchUrl:y,setClientTools:Y}},/*#__PURE__*/e.createElement(m,{serverUrl:k,token:a,connect:i,onConnected:q,onDisconnected:z,onError:K,roomConnected:V,callbacks:I.current,onParticipantReady:Q,sendMessage:G,clientTools:F.current,updateCurrentEventId:H},l))};export{f as ElevenLabsProvider,k as useConversation};
 //# sourceMappingURL=lib.modern.js.map
diff --git a/node_modules/@elevenlabs/react-native/dist/lib.module.js b/node_modules/@elevenlabs/react-native/dist/lib.module.js
index 7d7fb7c..8008f2b 100644
--- a/node_modules/@elevenlabs/react-native/dist/lib.module.js
+++ b/node_modules/@elevenlabs/react-native/dist/lib.module.js
@@ -1,2 +1,2 @@
-import e,{useRef as n,useCallback as t,useState as r,useEffect as o,useContext as c,createContext as a}from"react";import{AudioSession as l,useLocalParticipant as i,useDataChannel as s,LiveKitRoom as u,registerGlobals as d}from"@livekit/react-native";function v(){return v=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},v.apply(null,arguments)}var f="0.2.1",m=function(n){var t=n.onReady,r=n.isConnected,c=n.callbacks,a=n.sendMessage,l=n.clientTools,u=void 0===l?{}:l,d=n.updateCurrentEventId,v=i().localParticipant,f=e.useRef(1);return o(function(){r&&v&&t(v)},[r,v,t]),s(function(e){var n,t,r=new TextDecoder,o=JSON.parse(r.decode(e.payload));if(o.type){var l;if(null==c.onMessage||c.onMessage({message:o,source:null!=(n=e.from)&&n.isAgent?"ai":"user"}),null!=(t=e.from)&&t.isAgent&&(null==c.onModeChange||c.onModeChange({mode:null!=(l=e.from)&&l.isSpeaking?"speaking":"listening"}),"agent_response"===o.type&&d)){var i=f.current++;d(i)}switch(o.type){case"ping":a({type:"pong",event_id:o.ping_event.event_id});break;case"client_tool_call":!function(e){try{return Promise.resolve(function(){if(Object.prototype.hasOwnProperty.call(u,e.client_tool_call.tool_name)){var n=function(n,t){try{var r=Promise.resolve(u[e.client_tool_call.tool_name](e.client_tool_call.parameters)).then(function(n){var t="object"==typeof n?JSON.stringify(n):String(n);a({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!1})})}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(0,function(n){null==c.onError||c.onError("Client tool execution failed with following error: "+(null==n?void 0:n.message),{clientToolName:e.client_tool_call.tool_name}),a({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:"Client tool execution failed: "+(null==n?void 0:n.message),is_error:!0})});if(n&&n.then)return n.then(function(){})}else{if(c.onUnhandledClientToolCall)return void c.onUnhandledClientToolCall(e);var t="Client tool with name "+e.client_tool_call.tool_name+" is not defined on client";null==c.onError||c.onError(t,{clientToolName:e.client_tool_call.tool_name}),a({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!0})}}())}catch(e){return Promise.reject(e)}}(o);break;default:null==c.onDebug||c.onDebug(o)}}else null==c.onDebug||c.onDebug({type:"invalid_event",message:o})}),null},h=function(n){var t=n.children;/*#__PURE__*/return e.createElement(u,{serverUrl:n.serverUrl,token:n.token,connect:n.connect,audio:!0,video:!1,options:{adaptiveStream:{pixelDensity:"screen"}},onConnected:n.onConnected,onDisconnected:n.onDisconnected,onError:n.onError},/*#__PURE__*/e.createElement(m,{onReady:n.onParticipantReady,isConnected:n.roomConnected,callbacks:n.callbacks,sendMessage:n.sendMessage,clientTools:n.clientTools,updateCurrentEventId:n.updateCurrentEventId}),t)},g=["serverUrl","tokenFetchUrl","clientTools"],_=/*#__PURE__*/a(null),p=function(n){void 0===n&&(n={});var t=c(_);if(!t)throw new Error("useConversation must be used within ElevenLabsProvider");var r=n.serverUrl,o=n.tokenFetchUrl,a=n.clientTools,l=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(n,g);return e.useEffect(function(){r&&t.setServerUrl(r)},[t,r]),e.useEffect(function(){o&&t.setTokenFetchUrl(o)},[t,o]),a&&t.setClientTools(a),t.setCallbacks(l),t.conversation},C=function(c){var a=c.children;d();var i=r(""),s=i[0],u=i[1],m=r(!1),g=m[0],p=m[1],C=r("disconnected"),k=C[0],y=C[1],b=r("wss://livekit.rtc.elevenlabs.io"),E=b[0],S=b[1],P=r(void 0),w=P[0],x=P[1],T=r(""),U=T[0],D=T[1],F=r(!1),I=F[0],M=F[1],R=r(!1),O=R[0],j=R[1],L=e.useRef(1),N=e.useRef(1),A=e.useRef({}),V=function(){var e=n({}),r=t(function(n){e.current=n},[]);return{callbacksRef:e,setCallbacks:r}}(),B=V.callbacksRef,J=V.setCallbacks,K=e.useCallback(function(e){var n=v({},e,{onModeChange:function(n){M("speaking"===n.mode),null==e.onModeChange||e.onModeChange(n)}});J(n)},[J]),q=function(e,n,o,c,a,l){var i=r({}),s=i[0],u=i[1],d=r(null),v=d[0],m=d[1],h=r({}),g=h[0],_=h[1];return{startSession:t(function(t){try{return Promise.resolve(function(r,i){try{var s=function(){function r(e){var n=function(e){try{var n,t;return(null==(t=((null==(n=JSON.parse(atob(e.split(".")[1])).video)?void 0:n.room)||"").match(/(conv_[a-zA-Z0-9]+)/))?void 0:t[0])||""}catch(e){return console.warn("Could not extract conversation ID from token"),""}}(i);a(n),c(i),o(!0)}var i;n("connecting"),null==e.current.onStatusChange||e.current.onStatusChange({status:"connecting"}),u(t.overrides||{}),m(t.customLlmExtraBody||null),_(t.dynamicVariables||{});var s=function(){if(!t.conversationToken)return function(){if(t.agentId)return console.info("Getting conversation token for agentId:",t.agentId),Promise.resolve(function(e,n){try{return Promise.resolve(fetch((n||"https://api.elevenlabs.io/v1/convai/conversation/token")+"?agent_id="+e+"&source=react_native_sdk&version="+f)).then(function(e){return Promise.resolve(e.json()).then(function(n){if(!e.ok)throw new Error("Failed to get conversation token: "+n.detail.message);if(!n.token)throw new Error("No conversation token received from API");return n.token})})}catch(e){return Promise.reject(e)}}(t.agentId,t.tokenFetchUrl||l)).then(function(e){i=e});throw new Error("Either conversationToken or agentId is required")}();i=t.conversationToken}();return s&&s.then?s.then(r):r()}()}catch(e){return i(e)}return s&&s.then?s.then(void 0,i):s}(0,function(t){throw n("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onError||e.current.onError(t),t}))}catch(e){return Promise.reject(e)}},[e,n,o,c,a,l]),endSession:t(function(){try{try{o(!1),c(""),n("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onDisconnect||e.current.onDisconnect("User ended conversation")}catch(n){throw null==e.current.onError||e.current.onError(n),n}return Promise.resolve()}catch(e){return Promise.reject(e)}},[e,o,c,n]),overrides:s,customLlmExtraBody:v,dynamicVariables:g}}(B,y,p,u,D,w),z=q.startSession,G=q.endSession,W=q.overrides,Z=q.customLlmExtraBody,H=q.dynamicVariables,Q=function(e,n,c){var a=r(!1),i=a[0],s=a[1],u=r(null),d=u[0],v=u[1];return o(function(){return function(){try{return Promise.resolve(l.startAudioSession()).then(function(){})}catch(e){return Promise.reject(e)}}(),function(){l.stopAudioSession()}},[]),{roomConnected:i,localParticipant:d,handleParticipantReady:t(function(e){v(e)},[]),handleConnected:t(function(){s(!0),n("connected"),null==e.current.onConnect||e.current.onConnect({conversationId:c})},[c,e,n]),handleDisconnected:t(function(){s(!1),n("disconnected"),v(null),null==e.current.onDisconnect||e.current.onDisconnect("disconnected")},[e,n]),handleError:t(function(n){console.error("LiveKit error:",n),null==e.current.onError||e.current.onError(n.message,void 0)},[e])}}(B,y,U),X=Q.roomConnected,Y=Q.localParticipant,$=Q.handleParticipantReady,ee=Q.handleConnected,ne=Q.handleDisconnected,te=Q.handleError,re=e.useCallback(function(){L.current=1,N.current=1,j(!1),null==B.current.onCanSendFeedbackChange||B.current.onCanSendFeedbackChange({canSendFeedback:!1}),ee()},[ee,B]),oe=e.useCallback(function(){j(!1),ne()},[ne]),ce=function(e,n,r){return{sendMessage:t(function(t){try{if("connected"!==e||!n)return console.warn("Cannot send message: room not connected or no local participant"),Promise.resolve();var o=function(e,r){try{var o=(c=(new TextEncoder).encode(JSON.stringify(t)),Promise.resolve(n.publishData(c,{reliable:!0})).then(function(){}))}catch(e){return r(e)}var c;return o&&o.then?o.then(void 0,r):o}(0,function(e){console.error("Failed to send message via WebRTC:",e),console.error("Error details:",e),null==r.current.onError||r.current.onError(e)});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},[e,n,r])}}(k,Y,B),ae=ce.sendMessage,le=e.useCallback(function(){var e=L.current!==N.current;O!==e&&(j(e),null==B.current.onCanSendFeedbackChange||B.current.onCanSendFeedbackChange({canSendFeedback:e}))},[O,B]),ie=e.useCallback(function(e){O?(ae({type:"feedback",score:e?"like":"dislike",event_id:L.current}),N.current=L.current,le()):console.warn(0===N.current?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},[O,ae,le]);e.useCallback(function(e){console.warn("setVolume is not yet implemented in React Native SDK")},[]);var se=e.useCallback(function(e){L.current=e,le()},[le]),ue=e.useCallback(function(e){if($(e),Y){var n=function(e){var n,t,r,o,c,a,l={type:"conversation_initiation_client_data"};return e.overrides&&(l.conversation_config_override={agent:{prompt:null==(n=e.overrides.agent)?void 0:n.prompt,first_message:null==(t=e.overrides.agent)?void 0:t.firstMessage,language:null==(r=e.overrides.agent)?void 0:r.language},tts:{voice_id:null==(o=e.overrides.tts)?void 0:o.voiceId},conversation:{text_only:null==(c=e.overrides.conversation)?void 0:c.textOnly},source_info:{source:"react_native_sdk",version:(null==(a=e.overrides)||null==(a=a.client)?void 0:a.version)||f}}),e.customLlmExtraBody&&(l.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(l.dynamic_variables=e.dynamicVariables),e.userId&&(l.user_id=e.userId),l}({overrides:W,customLlmExtraBody:Z,dynamicVariables:H});ae(n)}},[$,Y,W,Z,H,ae]),de={startSession:z,endSession:G,status:k,isSpeaking:I,canSendFeedback:O,getId:function(){return U},sendFeedback:ie,sendContextualUpdate:function(e){ae({type:"contextual_update",text:e})},sendUserMessage:function(e){ae({type:"user_message",text:e})},sendUserActivity:function(){ae({type:"user_activity"})}},ve=e.useCallback(function(e){A.current=e},[]);/*#__PURE__*/return e.createElement(_.Provider,{value:{conversation:de,callbacksRef:B,serverUrl:E,tokenFetchUrl:w,clientTools:A.current,setCallbacks:K,setServerUrl:S,setTokenFetchUrl:x,setClientTools:ve}},/*#__PURE__*/e.createElement(h,{serverUrl:E,token:s,connect:g,onConnected:re,onDisconnected:oe,onError:te,roomConnected:X,callbacks:B.current,onParticipantReady:ue,sendMessage:ae,clientTools:A.current,updateCurrentEventId:se},a))};export{C as ElevenLabsProvider,p as useConversation};
+import e,{useRef as n,useCallback as t,useState as r,useEffect as o,useContext as c,createContext as a}from"react";import{AudioSession as l,useLocalParticipant as i,useDataChannel as s,LiveKitRoom as u,registerGlobals as d}from"@livekit/react-native";function v(){return v=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},v.apply(null,arguments)}var f="0.2.1",m=function(n){var t=n.onReady,r=n.isConnected,c=n.callbacks,a=n.sendMessage,l=n.clientTools,u=void 0===l?{}:l,d=n.updateCurrentEventId,v=i().localParticipant,f=e.useRef(1);return o(function(){r&&v&&t(v)},[r,v,t]),s(function(e){var n,t,r=new TextDecoder,o=JSON.parse(r.decode(e.payload));if(o.type){var l;if(null==c.onMessage||c.onMessage({message:o,source:null!=(n=e.from)&&n.isAgent?"ai":"user"}),null!=(t=e.from)&&t.isAgent&&(null==c.onModeChange||c.onModeChange({mode:null!=(l=e.from)&&l.isSpeaking?"speaking":"listening"}),"agent_response"===o.type&&d)){var i=f.current++;d(i)}switch(o.type){case"ping":a({type:"pong",event_id:o.ping_event.event_id});break;case"client_tool_call":!function(e){try{return Promise.resolve(function(){if(Object.prototype.hasOwnProperty.call(u,e.client_tool_call.tool_name)){var n=function(n,t){try{var r=Promise.resolve(u[e.client_tool_call.tool_name](e.client_tool_call.parameters)).then(function(n){var t="object"==typeof n?JSON.stringify(n):String(n);a({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!1})})}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(0,function(n){null==c.onError||c.onError("Client tool execution failed with following error: "+(null==n?void 0:n.message),{clientToolName:e.client_tool_call.tool_name}),a({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:"Client tool execution failed: "+(null==n?void 0:n.message),is_error:!0})});if(n&&n.then)return n.then(function(){})}else{if(c.onUnhandledClientToolCall)return void c.onUnhandledClientToolCall(e);var t="Client tool with name "+e.client_tool_call.tool_name+" is not defined on client";null==c.onError||c.onError(t,{clientToolName:e.client_tool_call.tool_name}),a({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!0})}}())}catch(e){return Promise.reject(e)}}(o);break;default:null==c.onDebug||c.onDebug(o)}}else null==c.onDebug||c.onDebug({type:"invalid_event",message:o})}),null},h=function(n){var t=n.children;/*#__PURE__*/return e.createElement(u,{serverUrl:n.serverUrl,token:n.token,connect:n.connect,audio:!0,video:!1,options:{adaptiveStream:{pixelDensity:"screen"}},onConnected:n.onConnected,onDisconnected:n.onDisconnected,onError:n.onError},/*#__PURE__*/e.createElement(m,{onReady:n.onParticipantReady,isConnected:n.roomConnected,callbacks:n.callbacks,sendMessage:n.sendMessage,clientTools:n.clientTools,updateCurrentEventId:n.updateCurrentEventId}),t)},g=["serverUrl","tokenFetchUrl","clientTools"],_=/*#__PURE__*/a(null),p=function(n){void 0===n&&(n={});var t=c(_);if(!t)throw new Error("useConversation must be used within ElevenLabsProvider");var r=n.serverUrl,o=n.tokenFetchUrl,a=n.clientTools,l=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(n,g);return e.useEffect(function(){r&&t.setServerUrl(r)},[t,r]),e.useEffect(function(){o&&t.setTokenFetchUrl(o)},[t,o]),a&&t.setClientTools(a),t.setCallbacks(l),t.conversation},C=function(c){var a=c.children;d();var i=r(""),s=i[0],u=i[1],m=r(!1),g=m[0],p=m[1],C=r("disconnected"),k=C[0],y=C[1],b=r("wss://livekit.rtc.elevenlabs.io"),E=b[0],S=b[1],P=r(void 0),w=P[0],x=P[1],T=r(""),U=T[0],D=T[1],F=r(!1),I=F[0],M=F[1],R=r(!1),O=R[0],j=R[1],L=e.useRef(1),N=e.useRef(1),A=e.useRef({}),V=function(){var e=n({}),r=t(function(n){e.current=n},[]);return{callbacksRef:e,setCallbacks:r}}(),B=V.callbacksRef,J=V.setCallbacks,K=e.useCallback(function(e){var n=v({},e,{onModeChange:function(n){M("speaking"===n.mode),null==e.onModeChange||e.onModeChange(n)}});J(n)},[J]),q=function(e,n,o,c,a,l){var i=r({}),s=i[0],u=i[1],d=r(null),v=d[0],m=d[1],h=r({}),g=h[0],_=h[1];return{startSession:t(function(t){try{return Promise.resolve(function(r,i){try{var s=function(){function r(e){var n=function(e){try{var n,t;return(null==(t=((null==(n=JSON.parse(atob(e.split(".")[1])).video)?void 0:n.room)||"").match(/(conv_[a-zA-Z0-9]+)/))?void 0:t[0])||""}catch(e){return console.warn("Could not extract conversation ID from token"),""}}(i);a(n),c(i),o(!0)}var i;n("connecting"),null==e.current.onStatusChange||e.current.onStatusChange({status:"connecting"}),u(t.overrides||{}),m(t.customLlmExtraBody||null),_(t.dynamicVariables||{});var s=function(){if(!t.conversationToken)return function(){if(t.agentId)return console.info("Getting conversation token for agentId:",t.agentId),Promise.resolve(function(e,n){try{return Promise.resolve(fetch((n||"https://api.elevenlabs.io/v1/convai/conversation/token")+"?agent_id="+e+"&source=react_native_sdk&version="+f)).then(function(e){return Promise.resolve(e.json()).then(function(n){if(!e.ok)throw new Error("Failed to get conversation token: "+n.detail.message);if(!n.token)throw new Error("No conversation token received from API");return n.token})})}catch(e){return Promise.reject(e)}}(t.agentId,t.tokenFetchUrl||l)).then(function(e){i=e});throw new Error("Either conversationToken or agentId is required")}();i=t.conversationToken}();return s&&s.then?s.then(r):r()}()}catch(e){return i(e)}return s&&s.then?s.then(void 0,i):s}(0,function(t){throw n("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onError||e.current.onError(t),t}))}catch(e){return Promise.reject(e)}},[e,n,o,c,a,l]),endSession:t(function(){try{try{o(!1),c(""),n("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onDisconnect||e.current.onDisconnect("User ended conversation")}catch(n){throw null==e.current.onError||e.current.onError(n),n}return Promise.resolve()}catch(e){return Promise.reject(e)}},[e,o,c,n]),overrides:s,customLlmExtraBody:v,dynamicVariables:g}}(B,y,p,u,D,w),z=q.startSession,G=q.endSession,W=q.overrides,Z=q.customLlmExtraBody,H=q.dynamicVariables,Q=function(e,n,c,_connect){var a=r(!1),i=a[0],s=a[1],u=r(null),d=u[0],v=u[1];return o(function(){if(_connect){return function(){try{return Promise.resolve(l.startAudioSession()).then(function(){})}catch(e){return Promise.reject(e)}}(),function(){l.stopAudioSession()}}},[_connect]),{roomConnected:i,localParticipant:d,handleParticipantReady:t(function(e){v(e)},[]),handleConnected:t(function(){s(!0),n("connected"),null==e.current.onConnect||e.current.onConnect({conversationId:c})},[c,e,n]),handleDisconnected:t(function(){s(!1),n("disconnected"),v(null),null==e.current.onDisconnect||e.current.onDisconnect("disconnected")},[e,n]),handleError:t(function(n){console.error("LiveKit error:",n),null==e.current.onError||e.current.onError(n.message,void 0)},[e])}}(B,y,U,g),X=Q.roomConnected,Y=Q.localParticipant,$=Q.handleParticipantReady,ee=Q.handleConnected,ne=Q.handleDisconnected,te=Q.handleError,re=e.useCallback(function(){L.current=1,N.current=1,j(!1),null==B.current.onCanSendFeedbackChange||B.current.onCanSendFeedbackChange({canSendFeedback:!1}),ee()},[ee,B]),oe=e.useCallback(function(){j(!1),ne()},[ne]),ce=function(e,n,r){return{sendMessage:t(function(t){try{if("connected"!==e||!n)return console.warn("Cannot send message: room not connected or no local participant"),Promise.resolve();var o=function(e,r){try{var o=(c=(new TextEncoder).encode(JSON.stringify(t)),Promise.resolve(n.publishData(c,{reliable:!0})).then(function(){}))}catch(e){return r(e)}var c;return o&&o.then?o.then(void 0,r):o}(0,function(e){console.error("Failed to send message via WebRTC:",e),console.error("Error details:",e),null==r.current.onError||r.current.onError(e)});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},[e,n,r])}}(k,Y,B),ae=ce.sendMessage,le=e.useCallback(function(){var e=L.current!==N.current;O!==e&&(j(e),null==B.current.onCanSendFeedbackChange||B.current.onCanSendFeedbackChange({canSendFeedback:e}))},[O,B]),ie=e.useCallback(function(e){O?(ae({type:"feedback",score:e?"like":"dislike",event_id:L.current}),N.current=L.current,le()):console.warn(0===N.current?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},[O,ae,le]);e.useCallback(function(e){console.warn("setVolume is not yet implemented in React Native SDK")},[]);var se=e.useCallback(function(e){L.current=e,le()},[le]),ue=e.useCallback(function(e){if($(e),Y){var n=function(e){var n,t,r,o,c,a,l={type:"conversation_initiation_client_data"};return e.overrides&&(l.conversation_config_override={agent:{prompt:null==(n=e.overrides.agent)?void 0:n.prompt,first_message:null==(t=e.overrides.agent)?void 0:t.firstMessage,language:null==(r=e.overrides.agent)?void 0:r.language},tts:{voice_id:null==(o=e.overrides.tts)?void 0:o.voiceId},conversation:{text_only:null==(c=e.overrides.conversation)?void 0:c.textOnly},source_info:{source:"react_native_sdk",version:(null==(a=e.overrides)||null==(a=a.client)?void 0:a.version)||f}}),e.customLlmExtraBody&&(l.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(l.dynamic_variables=e.dynamicVariables),e.userId&&(l.user_id=e.userId),l}({overrides:W,customLlmExtraBody:Z,dynamicVariables:H});ae(n)}},[$,Y,W,Z,H,ae]),de={startSession:z,endSession:G,status:k,isSpeaking:I,canSendFeedback:O,getId:function(){return U},sendFeedback:ie,sendContextualUpdate:function(e){ae({type:"contextual_update",text:e})},sendUserMessage:function(e){ae({type:"user_message",text:e})},sendUserActivity:function(){ae({type:"user_activity"})}},ve=e.useCallback(function(e){A.current=e},[]);/*#__PURE__*/return e.createElement(_.Provider,{value:{conversation:de,callbacksRef:B,serverUrl:E,tokenFetchUrl:w,clientTools:A.current,setCallbacks:K,setServerUrl:S,setTokenFetchUrl:x,setClientTools:ve}},/*#__PURE__*/e.createElement(h,{serverUrl:E,token:s,connect:g,onConnected:re,onDisconnected:oe,onError:te,roomConnected:X,callbacks:B.current,onParticipantReady:ue,sendMessage:ae,clientTools:A.current,updateCurrentEventId:se},a))};export{C as ElevenLabsProvider,p as useConversation};
 //# sourceMappingURL=lib.module.js.map
diff --git a/node_modules/@elevenlabs/react-native/dist/lib.umd.js b/node_modules/@elevenlabs/react-native/dist/lib.umd.js
index 6447d30..d635cae 100644
--- a/node_modules/@elevenlabs/react-native/dist/lib.umd.js
+++ b/node_modules/@elevenlabs/react-native/dist/lib.umd.js
@@ -1,2 +1,2 @@
-!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react"),require("@livekit/react-native")):"function"==typeof define&&define.amd?define(["exports","react","@livekit/react-native"],n):n((e||self).reactNative={},e.react,e.reactNative)}(this,function(e,n,t){function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=/*#__PURE__*/r(n);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},a.apply(null,arguments)}var c="0.2.1",l=function(e){var r=e.onReady,a=e.isConnected,c=e.callbacks,l=e.sendMessage,i=e.clientTools,s=void 0===i?{}:i,u=e.updateCurrentEventId,d=t.useLocalParticipant().localParticipant,f=o.default.useRef(1);return n.useEffect(function(){a&&d&&r(d)},[a,d,r]),t.useDataChannel(function(e){var n,t,r=new TextDecoder,o=JSON.parse(r.decode(e.payload));if(o.type){var a;if(null==c.onMessage||c.onMessage({message:o,source:null!=(n=e.from)&&n.isAgent?"ai":"user"}),null!=(t=e.from)&&t.isAgent&&(null==c.onModeChange||c.onModeChange({mode:null!=(a=e.from)&&a.isSpeaking?"speaking":"listening"}),"agent_response"===o.type&&u)){var i=f.current++;u(i)}switch(o.type){case"ping":l({type:"pong",event_id:o.ping_event.event_id});break;case"client_tool_call":!function(e){try{return Promise.resolve(function(){if(Object.prototype.hasOwnProperty.call(s,e.client_tool_call.tool_name)){var n=function(n,t){try{var r=Promise.resolve(s[e.client_tool_call.tool_name](e.client_tool_call.parameters)).then(function(n){var t="object"==typeof n?JSON.stringify(n):String(n);l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!1})})}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(0,function(n){null==c.onError||c.onError("Client tool execution failed with following error: "+(null==n?void 0:n.message),{clientToolName:e.client_tool_call.tool_name}),l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:"Client tool execution failed: "+(null==n?void 0:n.message),is_error:!0})});if(n&&n.then)return n.then(function(){})}else{if(c.onUnhandledClientToolCall)return void c.onUnhandledClientToolCall(e);var t="Client tool with name "+e.client_tool_call.tool_name+" is not defined on client";null==c.onError||c.onError(t,{clientToolName:e.client_tool_call.tool_name}),l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!0})}}())}catch(e){return Promise.reject(e)}}(o);break;default:null==c.onDebug||c.onDebug(o)}}else null==c.onDebug||c.onDebug({type:"invalid_event",message:o})}),null},i=function(e){var n=e.children;/*#__PURE__*/return o.default.createElement(t.LiveKitRoom,{serverUrl:e.serverUrl,token:e.token,connect:e.connect,audio:!0,video:!1,options:{adaptiveStream:{pixelDensity:"screen"}},onConnected:e.onConnected,onDisconnected:e.onDisconnected,onError:e.onError},/*#__PURE__*/o.default.createElement(l,{onReady:e.onParticipantReady,isConnected:e.roomConnected,callbacks:e.callbacks,sendMessage:e.sendMessage,clientTools:e.clientTools,updateCurrentEventId:e.updateCurrentEventId}),n)},s=["serverUrl","tokenFetchUrl","clientTools"],u=/*#__PURE__*/n.createContext(null);e.ElevenLabsProvider=function(e){var r=e.children;t.registerGlobals();var l=n.useState(""),s=l[0],d=l[1],f=n.useState(!1),v=f[0],h=f[1],m=n.useState("disconnected"),g=m[0],C=m[1],_=n.useState("wss://livekit.rtc.elevenlabs.io"),b=_[0],k=_[1],p=n.useState(void 0),y=p[0],S=p[1],E=n.useState(""),P=E[0],w=E[1],x=n.useState(!1),T=x[0],U=x[1],D=n.useState(!1),R=D[0],F=D[1],I=o.default.useRef(1),M=o.default.useRef(1),j=o.default.useRef({}),O=function(){var e=n.useRef({}),t=n.useCallback(function(n){e.current=n},[]);return{callbacksRef:e,setCallbacks:t}}(),L=O.callbacksRef,N=O.setCallbacks,A=o.default.useCallback(function(e){var n=a({},e,{onModeChange:function(n){U("speaking"===n.mode),null==e.onModeChange||e.onModeChange(n)}});N(n)},[N]),V=function(e,t,r,o,a,l){var i=n.useState({}),s=i[0],u=i[1],d=n.useState(null),f=d[0],v=d[1],h=n.useState({}),m=h[0],g=h[1];return{startSession:n.useCallback(function(n){try{return Promise.resolve(function(i,s){try{var d=function(){function i(e){var n=function(e){try{var n,t;return(null==(t=((null==(n=JSON.parse(atob(e.split(".")[1])).video)?void 0:n.room)||"").match(/(conv_[a-zA-Z0-9]+)/))?void 0:t[0])||""}catch(e){return console.warn("Could not extract conversation ID from token"),""}}(s);a(n),o(s),r(!0)}var s;t("connecting"),null==e.current.onStatusChange||e.current.onStatusChange({status:"connecting"}),u(n.overrides||{}),v(n.customLlmExtraBody||null),g(n.dynamicVariables||{});var d=function(){if(!n.conversationToken)return function(){if(n.agentId)return console.info("Getting conversation token for agentId:",n.agentId),Promise.resolve(function(e,n){try{return Promise.resolve(fetch((n||"https://api.elevenlabs.io/v1/convai/conversation/token")+"?agent_id="+e+"&source=react_native_sdk&version="+c)).then(function(e){return Promise.resolve(e.json()).then(function(n){if(!e.ok)throw new Error("Failed to get conversation token: "+n.detail.message);if(!n.token)throw new Error("No conversation token received from API");return n.token})})}catch(e){return Promise.reject(e)}}(n.agentId,n.tokenFetchUrl||l)).then(function(e){s=e});throw new Error("Either conversationToken or agentId is required")}();s=n.conversationToken}();return d&&d.then?d.then(i):i()}()}catch(e){return s(e)}return d&&d.then?d.then(void 0,s):d}(0,function(n){throw t("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onError||e.current.onError(n),n}))}catch(e){return Promise.reject(e)}},[e,t,r,o,a,l]),endSession:n.useCallback(function(){try{try{r(!1),o(""),t("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onDisconnect||e.current.onDisconnect("User ended conversation")}catch(n){throw null==e.current.onError||e.current.onError(n),n}return Promise.resolve()}catch(e){return Promise.reject(e)}},[e,r,o,t]),overrides:s,customLlmExtraBody:f,dynamicVariables:m}}(L,C,h,d,w,y),B=V.startSession,J=V.endSession,q=V.overrides,K=V.customLlmExtraBody,G=V.dynamicVariables,z=function(e,r,o){var a=n.useState(!1),c=a[0],l=a[1],i=n.useState(null),s=i[0],u=i[1];return n.useEffect(function(){return function(){try{return Promise.resolve(t.AudioSession.startAudioSession()).then(function(){})}catch(e){return Promise.reject(e)}}(),function(){t.AudioSession.stopAudioSession()}},[]),{roomConnected:c,localParticipant:s,handleParticipantReady:n.useCallback(function(e){u(e)},[]),handleConnected:n.useCallback(function(){l(!0),r("connected"),null==e.current.onConnect||e.current.onConnect({conversationId:o})},[o,e,r]),handleDisconnected:n.useCallback(function(){l(!1),r("disconnected"),u(null),null==e.current.onDisconnect||e.current.onDisconnect("disconnected")},[e,r]),handleError:n.useCallback(function(n){console.error("LiveKit error:",n),null==e.current.onError||e.current.onError(n.message,void 0)},[e])}}(L,C,P),W=z.roomConnected,Z=z.localParticipant,H=z.handleParticipantReady,Q=z.handleConnected,X=z.handleDisconnected,Y=z.handleError,$=o.default.useCallback(function(){I.current=1,M.current=1,F(!1),null==L.current.onCanSendFeedbackChange||L.current.onCanSendFeedbackChange({canSendFeedback:!1}),Q()},[Q,L]),ee=o.default.useCallback(function(){F(!1),X()},[X]),ne=function(e,t,r){return{sendMessage:n.useCallback(function(n){try{if("connected"!==e||!t)return console.warn("Cannot send message: room not connected or no local participant"),Promise.resolve();var o=function(e,r){try{var o=(a=(new TextEncoder).encode(JSON.stringify(n)),Promise.resolve(t.publishData(a,{reliable:!0})).then(function(){}))}catch(e){return r(e)}var a;return o&&o.then?o.then(void 0,r):o}(0,function(e){console.error("Failed to send message via WebRTC:",e),console.error("Error details:",e),null==r.current.onError||r.current.onError(e)});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},[e,t,r])}}(g,Z,L),te=ne.sendMessage,re=o.default.useCallback(function(){var e=I.current!==M.current;R!==e&&(F(e),null==L.current.onCanSendFeedbackChange||L.current.onCanSendFeedbackChange({canSendFeedback:e}))},[R,L]),oe=o.default.useCallback(function(e){R?(te({type:"feedback",score:e?"like":"dislike",event_id:I.current}),M.current=I.current,re()):console.warn(0===M.current?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},[R,te,re]);o.default.useCallback(function(e){console.warn("setVolume is not yet implemented in React Native SDK")},[]);var ae=o.default.useCallback(function(e){I.current=e,re()},[re]),ce=o.default.useCallback(function(e){if(H(e),Z){var n=function(e){var n,t,r,o,a,l,i={type:"conversation_initiation_client_data"};return e.overrides&&(i.conversation_config_override={agent:{prompt:null==(n=e.overrides.agent)?void 0:n.prompt,first_message:null==(t=e.overrides.agent)?void 0:t.firstMessage,language:null==(r=e.overrides.agent)?void 0:r.language},tts:{voice_id:null==(o=e.overrides.tts)?void 0:o.voiceId},conversation:{text_only:null==(a=e.overrides.conversation)?void 0:a.textOnly},source_info:{source:"react_native_sdk",version:(null==(l=e.overrides)||null==(l=l.client)?void 0:l.version)||c}}),e.customLlmExtraBody&&(i.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(i.dynamic_variables=e.dynamicVariables),e.userId&&(i.user_id=e.userId),i}({overrides:q,customLlmExtraBody:K,dynamicVariables:G});te(n)}},[H,Z,q,K,G,te]),le={startSession:B,endSession:J,status:g,isSpeaking:T,canSendFeedback:R,getId:function(){return P},sendFeedback:oe,sendContextualUpdate:function(e){te({type:"contextual_update",text:e})},sendUserMessage:function(e){te({type:"user_message",text:e})},sendUserActivity:function(){te({type:"user_activity"})}},ie=o.default.useCallback(function(e){j.current=e},[]);/*#__PURE__*/return o.default.createElement(u.Provider,{value:{conversation:le,callbacksRef:L,serverUrl:b,tokenFetchUrl:y,clientTools:j.current,setCallbacks:A,setServerUrl:k,setTokenFetchUrl:S,setClientTools:ie}},/*#__PURE__*/o.default.createElement(i,{serverUrl:b,token:s,connect:v,onConnected:$,onDisconnected:ee,onError:Y,roomConnected:W,callbacks:L.current,onParticipantReady:ce,sendMessage:te,clientTools:j.current,updateCurrentEventId:ae},r))},e.useConversation=function(e){void 0===e&&(e={});var t=n.useContext(u);if(!t)throw new Error("useConversation must be used within ElevenLabsProvider");var r=e.serverUrl,a=e.tokenFetchUrl,c=e.clientTools,l=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,s);return o.default.useEffect(function(){r&&t.setServerUrl(r)},[t,r]),o.default.useEffect(function(){a&&t.setTokenFetchUrl(a)},[t,a]),c&&t.setClientTools(c),t.setCallbacks(l),t.conversation}});
+!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react"),require("@livekit/react-native")):"function"==typeof define&&define.amd?define(["exports","react","@livekit/react-native"],n):n((e||self).reactNative={},e.react,e.reactNative)}(this,function(e,n,t){function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=/*#__PURE__*/r(n);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},a.apply(null,arguments)}var c="0.2.1",l=function(e){var r=e.onReady,a=e.isConnected,c=e.callbacks,l=e.sendMessage,i=e.clientTools,s=void 0===i?{}:i,u=e.updateCurrentEventId,d=t.useLocalParticipant().localParticipant,f=o.default.useRef(1);return n.useEffect(function(){a&&d&&r(d)},[a,d,r]),t.useDataChannel(function(e){var n,t,r=new TextDecoder,o=JSON.parse(r.decode(e.payload));if(o.type){var a;if(null==c.onMessage||c.onMessage({message:o,source:null!=(n=e.from)&&n.isAgent?"ai":"user"}),null!=(t=e.from)&&t.isAgent&&(null==c.onModeChange||c.onModeChange({mode:null!=(a=e.from)&&a.isSpeaking?"speaking":"listening"}),"agent_response"===o.type&&u)){var i=f.current++;u(i)}switch(o.type){case"ping":l({type:"pong",event_id:o.ping_event.event_id});break;case"client_tool_call":!function(e){try{return Promise.resolve(function(){if(Object.prototype.hasOwnProperty.call(s,e.client_tool_call.tool_name)){var n=function(n,t){try{var r=Promise.resolve(s[e.client_tool_call.tool_name](e.client_tool_call.parameters)).then(function(n){var t="object"==typeof n?JSON.stringify(n):String(n);l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!1})})}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(0,function(n){null==c.onError||c.onError("Client tool execution failed with following error: "+(null==n?void 0:n.message),{clientToolName:e.client_tool_call.tool_name}),l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:"Client tool execution failed: "+(null==n?void 0:n.message),is_error:!0})});if(n&&n.then)return n.then(function(){})}else{if(c.onUnhandledClientToolCall)return void c.onUnhandledClientToolCall(e);var t="Client tool with name "+e.client_tool_call.tool_name+" is not defined on client";null==c.onError||c.onError(t,{clientToolName:e.client_tool_call.tool_name}),l({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:t,is_error:!0})}}())}catch(e){return Promise.reject(e)}}(o);break;default:null==c.onDebug||c.onDebug(o)}}else null==c.onDebug||c.onDebug({type:"invalid_event",message:o})}),null},i=function(e){var n=e.children;/*#__PURE__*/return o.default.createElement(t.LiveKitRoom,{serverUrl:e.serverUrl,token:e.token,connect:e.connect,audio:!0,video:!1,options:{adaptiveStream:{pixelDensity:"screen"}},onConnected:e.onConnected,onDisconnected:e.onDisconnected,onError:e.onError},/*#__PURE__*/o.default.createElement(l,{onReady:e.onParticipantReady,isConnected:e.roomConnected,callbacks:e.callbacks,sendMessage:e.sendMessage,clientTools:e.clientTools,updateCurrentEventId:e.updateCurrentEventId}),n)},s=["serverUrl","tokenFetchUrl","clientTools"],u=/*#__PURE__*/n.createContext(null);e.ElevenLabsProvider=function(e){var r=e.children;t.registerGlobals();var l=n.useState(""),s=l[0],d=l[1],f=n.useState(!1),v=f[0],h=f[1],m=n.useState("disconnected"),g=m[0],C=m[1],_=n.useState("wss://livekit.rtc.elevenlabs.io"),b=_[0],k=_[1],p=n.useState(void 0),y=p[0],S=p[1],E=n.useState(""),P=E[0],w=E[1],x=n.useState(!1),T=x[0],U=x[1],D=n.useState(!1),R=D[0],F=D[1],I=o.default.useRef(1),M=o.default.useRef(1),j=o.default.useRef({}),O=function(){var e=n.useRef({}),t=n.useCallback(function(n){e.current=n},[]);return{callbacksRef:e,setCallbacks:t}}(),L=O.callbacksRef,N=O.setCallbacks,A=o.default.useCallback(function(e){var n=a({},e,{onModeChange:function(n){U("speaking"===n.mode),null==e.onModeChange||e.onModeChange(n)}});N(n)},[N]),V=function(e,t,r,o,a,l){var i=n.useState({}),s=i[0],u=i[1],d=n.useState(null),f=d[0],v=d[1],h=n.useState({}),m=h[0],g=h[1];return{startSession:n.useCallback(function(n){try{return Promise.resolve(function(i,s){try{var d=function(){function i(e){var n=function(e){try{var n,t;return(null==(t=((null==(n=JSON.parse(atob(e.split(".")[1])).video)?void 0:n.room)||"").match(/(conv_[a-zA-Z0-9]+)/))?void 0:t[0])||""}catch(e){return console.warn("Could not extract conversation ID from token"),""}}(s);a(n),o(s),r(!0)}var s;t("connecting"),null==e.current.onStatusChange||e.current.onStatusChange({status:"connecting"}),u(n.overrides||{}),v(n.customLlmExtraBody||null),g(n.dynamicVariables||{});var d=function(){if(!n.conversationToken)return function(){if(n.agentId)return console.info("Getting conversation token for agentId:",n.agentId),Promise.resolve(function(e,n){try{return Promise.resolve(fetch((n||"https://api.elevenlabs.io/v1/convai/conversation/token")+"?agent_id="+e+"&source=react_native_sdk&version="+c)).then(function(e){return Promise.resolve(e.json()).then(function(n){if(!e.ok)throw new Error("Failed to get conversation token: "+n.detail.message);if(!n.token)throw new Error("No conversation token received from API");return n.token})})}catch(e){return Promise.reject(e)}}(n.agentId,n.tokenFetchUrl||l)).then(function(e){s=e});throw new Error("Either conversationToken or agentId is required")}();s=n.conversationToken}();return d&&d.then?d.then(i):i()}()}catch(e){return s(e)}return d&&d.then?d.then(void 0,s):d}(0,function(n){throw t("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onError||e.current.onError(n),n}))}catch(e){return Promise.reject(e)}},[e,t,r,o,a,l]),endSession:n.useCallback(function(){try{try{r(!1),o(""),t("disconnected"),null==e.current.onStatusChange||e.current.onStatusChange({status:"disconnected"}),null==e.current.onDisconnect||e.current.onDisconnect("User ended conversation")}catch(n){throw null==e.current.onError||e.current.onError(n),n}return Promise.resolve()}catch(e){return Promise.reject(e)}},[e,r,o,t]),overrides:s,customLlmExtraBody:f,dynamicVariables:m}}(L,C,h,d,w,y),B=V.startSession,J=V.endSession,q=V.overrides,K=V.customLlmExtraBody,G=V.dynamicVariables,z=function(e,r,o,_connect){var a=n.useState(!1),c=a[0],l=a[1],i=n.useState(null),s=i[0],u=i[1];return n.useEffect(function(){if(_connect){return function(){try{return Promise.resolve(t.AudioSession.startAudioSession()).then(function(){})}catch(e){return Promise.reject(e)}}(),function(){t.AudioSession.stopAudioSession()}}},[_connect]),{roomConnected:c,localParticipant:s,handleParticipantReady:n.useCallback(function(e){u(e)},[]),handleConnected:n.useCallback(function(){l(!0),r("connected"),null==e.current.onConnect||e.current.onConnect({conversationId:o})},[o,e,r]),handleDisconnected:n.useCallback(function(){l(!1),r("disconnected"),u(null),null==e.current.onDisconnect||e.current.onDisconnect("disconnected")},[e,r]),handleError:n.useCallback(function(n){console.error("LiveKit error:",n),null==e.current.onError||e.current.onError(n.message,void 0)},[e])}}(L,C,P,v),W=z.roomConnected,Z=z.localParticipant,H=z.handleParticipantReady,Q=z.handleConnected,X=z.handleDisconnected,Y=z.handleError,$=o.default.useCallback(function(){I.current=1,M.current=1,F(!1),null==L.current.onCanSendFeedbackChange||L.current.onCanSendFeedbackChange({canSendFeedback:!1}),Q()},[Q,L]),ee=o.default.useCallback(function(){F(!1),X()},[X]),ne=function(e,t,r){return{sendMessage:n.useCallback(function(n){try{if("connected"!==e||!t)return console.warn("Cannot send message: room not connected or no local participant"),Promise.resolve();var o=function(e,r){try{var o=(a=(new TextEncoder).encode(JSON.stringify(n)),Promise.resolve(t.publishData(a,{reliable:!0})).then(function(){}))}catch(e){return r(e)}var a;return o&&o.then?o.then(void 0,r):o}(0,function(e){console.error("Failed to send message via WebRTC:",e),console.error("Error details:",e),null==r.current.onError||r.current.onError(e)});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},[e,t,r])}}(g,Z,L),te=ne.sendMessage,re=o.default.useCallback(function(){var e=I.current!==M.current;R!==e&&(F(e),null==L.current.onCanSendFeedbackChange||L.current.onCanSendFeedbackChange({canSendFeedback:e}))},[R,L]),oe=o.default.useCallback(function(e){R?(te({type:"feedback",score:e?"like":"dislike",event_id:I.current}),M.current=I.current,re()):console.warn(0===M.current?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")},[R,te,re]);o.default.useCallback(function(e){console.warn("setVolume is not yet implemented in React Native SDK")},[]);var ae=o.default.useCallback(function(e){I.current=e,re()},[re]),ce=o.default.useCallback(function(e){if(H(e),Z){var n=function(e){var n,t,r,o,a,l,i={type:"conversation_initiation_client_data"};return e.overrides&&(i.conversation_config_override={agent:{prompt:null==(n=e.overrides.agent)?void 0:n.prompt,first_message:null==(t=e.overrides.agent)?void 0:t.firstMessage,language:null==(r=e.overrides.agent)?void 0:r.language},tts:{voice_id:null==(o=e.overrides.tts)?void 0:o.voiceId},conversation:{text_only:null==(a=e.overrides.conversation)?void 0:a.textOnly},source_info:{source:"react_native_sdk",version:(null==(l=e.overrides)||null==(l=l.client)?void 0:l.version)||c}}),e.customLlmExtraBody&&(i.custom_llm_extra_body=e.customLlmExtraBody),e.dynamicVariables&&(i.dynamic_variables=e.dynamicVariables),e.userId&&(i.user_id=e.userId),i}({overrides:q,customLlmExtraBody:K,dynamicVariables:G});te(n)}},[H,Z,q,K,G,te]),le={startSession:B,endSession:J,status:g,isSpeaking:T,canSendFeedback:R,getId:function(){return P},sendFeedback:oe,sendContextualUpdate:function(e){te({type:"contextual_update",text:e})},sendUserMessage:function(e){te({type:"user_message",text:e})},sendUserActivity:function(){te({type:"user_activity"})}},ie=o.default.useCallback(function(e){j.current=e},[]);/*#__PURE__*/return o.default.createElement(u.Provider,{value:{conversation:le,callbacksRef:L,serverUrl:b,tokenFetchUrl:y,clientTools:j.current,setCallbacks:A,setServerUrl:k,setTokenFetchUrl:S,setClientTools:ie}},/*#__PURE__*/o.default.createElement(i,{serverUrl:b,token:s,connect:v,onConnected:$,onDisconnected:ee,onError:Y,roomConnected:W,callbacks:L.current,onParticipantReady:ce,sendMessage:te,clientTools:j.current,updateCurrentEventId:ae},r))},e.useConversation=function(e){void 0===e&&(e={});var t=n.useContext(u);if(!t)throw new Error("useConversation must be used within ElevenLabsProvider");var r=e.serverUrl,a=e.tokenFetchUrl,c=e.clientTools,l=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,s);return o.default.useEffect(function(){r&&t.setServerUrl(r)},[t,r]),o.default.useEffect(function(){a&&t.setTokenFetchUrl(a)},[t,a]),c&&t.setClientTools(c),t.setCallbacks(l),t.conversation}});
 //# sourceMappingURL=lib.umd.js.map
